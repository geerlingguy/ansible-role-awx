---
- name: Include OS-specific variables.
  include_vars: "{{ ansible_os_family }}.yml"

- name: Make sure git is installed
  package:
    name: git
    state: present

- name: Clone AWX into configured directory.
  git:
    repo: "{{ awx_repo }}"
    dest: "{{ awx_repo_dir }}"
    version: "{{ awx_version }}"
    update: "{{ awx_keep_updated }}"
    force: yes
    accept_hostkey: yes

- name: Launch the playbook specific to the OS
  include: "awx-install-{{ ansible_os_family }}.yml"
  when: awx_run_install_playbook
